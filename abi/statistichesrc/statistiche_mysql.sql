/*
 * Author Inera srl https://www.inera.it
 * Copyright (C) 2023  Inera srl https://www.inera.it/
 *
 * European Union Public Licence V. 1.2
 * EUPL (c) the European Community 2017
 *
 * This European Union Public Licence (the "EUPL") applies to the Work or Software (as defined below) which is provided under the terms of this Licence.
 * Any use of the Work, other than as authorised under this Licence is prohibited (to the extent such use is covered by a right of the copyright holder of the Work).
 * The Original Work is provided under the terms of this Licence when the Licensor (as defined below) has placed the following notice immediately following the copyright notice for the Original Work:
 * Licensed under the EUPL V.1.2 or has expressed by any other mean his willingness to license under the EUPL.
 *
 * You should have received a copy of the European Union Public Licence V. 1.2 along with this program.  If not, see https://eupl.eu/1.2/en/
 */

TAVOLA01_1 = select r.denominazione as regione, count(*) as count, d.totale_abitanti as nabitanti from biblioteca as b, comune as c, provincia as p, regione as r, dati_regioni_istat as d where b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and r.id_regione=d.id_regione and b.id_stato_biblioteca_workflow != 4 group by r.denominazione, d.totale_abitanti, d.id_sort order by d.id_sort
TAVOLA01a_1 = select p.denominazione as provincia, r.denominazione as regione, count(*) as count, d.totale_abitanti as nabitanti from biblioteca as b, comune as c, provincia as p, regione as r, dati_province_istat as d, dati_regioni_istat as dr where b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and r.id_regione=dr.id_regione and p.id_provincia=d.id_provincia and (dr.descrizione_zona like '%SUD%' or dr.descrizione_zona like '%INSULARE%')  and b.id_stato_biblioteca_workflow != 4 group by p.denominazione, dr.id_sort, r.denominazione, d.totale_abitanti order by dr.id_sort, p.denominazione
TAVOLA01b_1 = select r.denominazione as regione, count(*) as count, d.totale_abitanti as nabitanti from biblioteca as b, comune as c, provincia as p, regione as r, dati_regioni_istat as d, ente as e where b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and r.id_regione=d.id_regione and b.id_stato_biblioteca_workflow != 4 group by r.denominazione, d.totale_abitanti, d.id_sort order by d.id_sort
TAVOLA01c_1 = select p1.denominazione as provincia, r.denominazione as regione, count(*) as count, d.totale_abitanti as nabitanti from biblioteca as b, comune as c, provincia as p1, regione as r, dati_province_istat as d, dati_regioni_istat as dr, ente as e where b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and b.id_comune=c.id_comune and c.id_provincia=p1.id_provincia and p1.id_regione=r.id_regione and r.id_regione=dr.id_regione and p1.id_provincia=d.id_provincia and (dr.descrizione_zona like '%SUD%' or dr.descrizione_zona like '%INSULARE%')  and b.id_stato_biblioteca_workflow != 4 group by p1.denominazione, dr.id_sort, r.denominazione, d.totale_abitanti order by dr.id_sort, p1.denominazione
TAVOLA02_1 = select r.denominazione as regione, t.descrizione, count(*) as count from dati_regioni_istat as dr, biblioteca as b, comune as c, provincia as p1, regione as r, tipologia_funzionale as t, ente as e where b.id_tipologia_funzionale=t.id_tipologia_funzionale and b.id_comune=c.id_comune and c.id_provincia=p1.id_provincia and p1.id_regione=r.id_regione and r.id_regione=dr.id_regione and t.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and b.id_stato_biblioteca_workflow != 4 group by r.denominazione, dr.id_sort, t.descrizione order by dr.id_sort, t.descrizione
TAVOLA02a_1 = select r.denominazione as regione, t.descrizione, count(*) as count from dati_regioni_istat as dr, biblioteca as b, comune as c, provincia as p, regione as r, tipologia_funzionale as t, ente as e where b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and r.id_regione=dr.id_regione and b.id_tipologia_funzionale=t.id_tipologia_funzionale and t.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by dr.id_sort, r.denominazione, t.descrizione order by dr.id_sort, r.denominazione, t.descrizione
TAVOLA02b_1 = select id_ente_tipologia_amministrativa as id_amm, descrizione as des_amm from ente_tipologia_amministrativa where id_ente_tipologia_amministrativa>0 and (id_ente_tipologia_amministrativa % 100)=0
TAVOLA02b_2 = select te.descrizione as tipologia_amministrativa, te.id_ente_tipologia_amministrativa as tipologia_amministrativa_id,  t.descrizione as tipologia_funzionale, count(*) as count from biblioteca as b, ente_tipologia_amministrativa as te, ente as e, tipologia_funzionale as t where b.id_tipologia_funzionale=t.id_tipologia_funzionale and b.id_ente=e.id_ente and te.id_ente_tipologia_amministrativa=e.id_ente_tipologia_amministrativa and e.id_ente_tipologia_amministrativa>0 and t.id_tipologia_funzionale>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and b.id_stato_biblioteca_workflow != 4 group by te.id_ente_tipologia_amministrativa, te.descrizione, t.descrizione, te.id_ente_tipologia_amministrativa order by te.descrizione, t.descrizione
TAVOLA02c_1 = select id_ente_tipologia_amministrativa as id_amm, descrizione as des_amm from ente_tipologia_amministrativa where id_ente_tipologia_amministrativa>0 and (id_ente_tipologia_amministrativa % 100)=0
TAVOLA02c_2 = select r.denominazione as regione, te.descrizione as tipologia_amministrativa , te.id_ente_tipologia_amministrativa as tipologia_amministrativa_id, count(*) as count from biblioteca as b, comune as c, provincia as p, regione as r, ente_tipologia_amministrativa as te, ente as e, dati_regioni_istat as dr where b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and b.id_tipologia_funzionale>0 and e.id_ente_tipologia_amministrativa=te.id_ente_tipologia_amministrativa and b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and r.id_regione=dr.id_regione and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by te.id_ente_tipologia_amministrativa, r.denominazione, te.descrizione, dr.id_sort  order by dr.id_sort, te.descrizione
TAVOLA02cp_1 = select id_ente_tipologia_amministrativa as id_amm, descrizione as des_amm from ente_tipologia_amministrativa where id_ente_tipologia_amministrativa>0 and (id_ente_tipologia_amministrativa % 100)=0
TAVOLA03_1 = select data_fondazione as fondazione, count(*) as count from biblioteca as b, ente as e where b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by fondazione order by fondazione
TAVOLA04_1 = select data_fondazione as fondazione, count(*) as count from biblioteca as b, ente as e where (data_fondazione like '20%' or data_fondazione like '19%') and b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and b.id_stato_biblioteca_workflow != 4 group by data_fondazione order by data_fondazione
TAVOLA05_1 = select r.denominazione as regione, b.accesso_riservato as stato_accesso, count(*) as count from dati_regioni_istat as dr, biblioteca as b, comune as c, provincia as p, regione as r, ente as e where b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and dr.id_regione=r.id_regione and b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by r.denominazione, b.accesso_riservato, dr.id_sort order by  dr.id_sort, r.denominazione
TAVOLA05a_1 = select te.descrizione, b.accesso_riservato as stato_accesso, count(*) as count from biblioteca as b, tipologia_funzionale as te, ente as e where b.id_tipologia_funzionale=te.id_tipologia_funzionale and te.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and b.id_stato_biblioteca_workflow != 4 group by te.descrizione, b.accesso_riservato order by te.descrizione
TAVOLA05b_1 = select t.descrizione as tipo from tipologia_funzionale as t where id_tipologia_funzionale>0
TAVOLA05b_2 = select q1.descr as tipo1, count(*) as tot from (select t.descrizione as descr, count(*) as count from biblioteca as b, tipologia_funzionale as t, ente as e where b.id_tipologia_funzionale=t.id_tipologia_funzionale and b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and t.id_tipologia_funzionale>0  and b.id_stato_biblioteca_workflow != 4 group by b.id_biblioteca, t.descrizione) as q1 group by q1.descr
TAVOLA05b_3 = select o.id_biblioteca, t.descrizione as descrizione , sum(substr(TIMEDIFF(o.alle,o.dalle), 1, position(':' in TIMEDIFF(o.alle,o.dalle))-1)*60+substr(TIMEDIFF(o.alle,o.dalle), position(':' in TIMEDIFF(o.alle,o.dalle))+1)) as sum from orario_ufficiali as o, biblioteca as b, tipologia_funzionale as t, ente as e where b.id_tipologia_funzionale=t.id_tipologia_funzionale and b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and o.id_biblioteca = b.id_biblioteca and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by o.id_biblioteca, t.descrizione order by o.id_biblioteca
TAVOLA06_1 = select r.denominazione as regione, count(*) as informazioni_bibliografiche from biblioteca as b, comune as c, provincia as p, regione as r, dati_regioni_istat as d, ente as e where b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and r.id_regione=d.id_regione and b.id_biblioteca=b.id_biblioteca and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and (b.gestisce_servizio_bibliografico_esterno=true or b.gestisce_servizio_bibliografico_interno=true)  and b.id_stato_biblioteca_workflow != 4 group by r.denominazione, d.id_sort order by d.id_sort
TAVOLA06_2 = select q1.regione1 as regione, count(*) as riproduzioni from (select distinct b.id_biblioteca, r.denominazione as regione1, dr.id_sort from comune as c, provincia as p, regione as r, riproduzioni as rip, biblioteca as b, dati_regioni_istat as dr, ente as e where b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and dr.id_regione=r.id_regione and b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and b.id_biblioteca=rip.id_biblioteca and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by r.denominazione, b.id_biblioteca, dr.id_sort order by dr.id_sort) as q1 group by q1.regione1, q1.id_sort order by q1.id_sort
TAVOLA06_3 = select r.denominazione as regione, count(*) as prestito_locale from comune as c, provincia as p, regione as r, dati_regioni_istat as dr, biblioteca as b, prestito_locale as pr, ente as e where b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and pr.id_biblioteca=b.id_biblioteca and dr.id_regione=r.id_regione and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by dr.id_sort, r.denominazione order by dr.id_sort
TAVOLA06_4 = select r.denominazione as regione, count(*) as prestito_interbibliotecario from comune as c, provincia as p, regione as r, dati_regioni_istat as dr, biblioteca as b, ente as e where  b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and (b.prestito_interbiblio_internazionale=true or b.prestito_interbiblio_nazionale=true) and dr.id_regione=r.id_regione and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by dr.id_sort, r.denominazione
TAVOLA06_5 = select r.denominazione as regione1, count(*) as numero_biblioteche from biblioteca as b, comune as c, provincia as p, regione as r, dati_regioni_istat as d, ente as e where b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and r.id_regione=d.id_regione and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by r.denominazione, d.id_sort order by d.id_sort
TAVOLA07_1 = select pc.descrizione, sum(p.quantita) as sum, pc.id_patrimonio_specializzazione_categoria_madre as id_patc_madre, pc.id_patrimonio_specializzazione_categoria as id_patc from patrimonio as p, patrimonio_specializzazione as ps, patrimonio_specializzazione_categoria as pc, biblioteca as b, ente as e where b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_biblioteca=b.id_biblioteca and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=pc.id_patrimonio_specializzazione_categoria and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and pc.id_patrimonio_specializzazione_categoria>0  and b.id_stato_biblioteca_workflow != 4 group by pc.id_patrimonio_specializzazione_categoria, pc.descrizione, pc.id_patrimonio_specializzazione_categoria_madre, pc.id_patrimonio_specializzazione_categoria order by pc.id_patrimonio_specializzazione_categoria
TAVOLA08_1 = select r.denominazione as regione, count(*) as count_manca from (select distinct biblio.id_biblioteca as id_bib, biblio.id_comune as id_loc, sum(p.quantita) as qq from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, biblio.id_ente, biblio.id_tipologia_funzionale, biblio.id_comune) as q, comune as c, provincia as pr, regione as r, dati_regioni_istat as dr where q.qq=0 and q.id_loc=c.id_comune and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=dr.id_regione group by r.denominazione, dr.id_sort order by dr.id_sort
TAVOLA08_2 = select r.denominazione as regione1, count(*) as count_fino from (select distinct biblio.id_biblioteca as id_bib, biblio.id_comune as id_loc, sum(p.quantita) as qq from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, biblio.id_ente, biblio.id_tipologia_funzionale, biblio.id_comune) as q, comune as c, provincia as pr, regione as r, dati_regioni_istat as dr where q.qq>0 and q.qq<=2000 and q.id_loc=c.id_comune and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=dr.id_regione group by r.denominazione, dr.id_sort order by dr.id_sort
TAVOLA08_3 = select r.denominazione as regione2, count(*) as count_da_2001 from (select distinct biblio.id_biblioteca as id_bib, biblio.id_comune as id_loc, sum(p.quantita) as qq from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, biblio.id_ente, biblio.id_tipologia_funzionale, biblio.id_comune) as q, comune as c, provincia as pr, regione as r, dati_regioni_istat as dr where q.qq>2000 and q.qq<=5000 and q.id_loc=c.id_comune and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=dr.id_regione group by r.denominazione, dr.id_sort order by dr.id_sort
TAVOLA08_4 = select r.denominazione as regione3, count(*) as count_da_5001 from (select distinct biblio.id_biblioteca as id_bib, biblio.id_comune as id_loc, sum(p.quantita) as qq from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, biblio.id_ente, biblio.id_tipologia_funzionale, biblio.id_comune) as q, comune as c, provincia as pr, regione as r, dati_regioni_istat as dr where q.qq>5000 and q.qq<=10000 and q.id_loc=c.id_comune and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=dr.id_regione group by r.denominazione, dr.id_sort order by dr.id_sort
TAVOLA08_5 = select r.denominazione as regione4, count(*) as count_da_10001 from (select distinct biblio.id_biblioteca as id_bib, biblio.id_comune as id_loc, sum(p.quantita) as qq from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, biblio.id_ente, biblio.id_tipologia_funzionale, biblio.id_comune) as q, comune as c, provincia as pr, regione as r, dati_regioni_istat as dr where q.qq>10000 and q.qq<=100000 and q.id_loc=c.id_comune and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=dr.id_regione group by r.denominazione, dr.id_sort order by dr.id_sort
TAVOLA08_6 = select r.denominazione as regione5, count(*) as count_da_100001 from (select distinct biblio.id_biblioteca as id_bib, biblio.id_comune as id_loc, sum(p.quantita) as qq from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, biblio.id_ente, biblio.id_tipologia_funzionale, biblio.id_comune) as q, comune as c, provincia as pr, regione as r, dati_regioni_istat as dr where q.qq>100000 and q.qq<=500000 and q.id_loc=c.id_comune and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=dr.id_regione group by r.denominazione, dr.id_sort order by dr.id_sort
TAVOLA08_7 = select r.denominazione as regione6, count(*) as count_da_500001 from (select distinct biblio.id_biblioteca as id_bib, biblio.id_comune as id_loc, sum(p.quantita) as qq from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, biblio.id_ente, biblio.id_tipologia_funzionale, biblio.id_comune) as q, comune as c, provincia as pr, regione as r, dati_regioni_istat as dr where q.qq>500000 and q.qq<=1000000 and q.id_loc=c.id_comune and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=dr.id_regione group by r.denominazione, dr.id_sort order by dr.id_sort
TAVOLA08_8 = select r.denominazione as regione7, count(*) as count_oltre from (select distinct biblio.id_biblioteca as id_bib, biblio.id_comune as id_loc, sum(p.quantita) as qq from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, biblio.id_ente, biblio.id_tipologia_funzionale, biblio.id_comune) as q, comune as c, provincia as pr, regione as r, dati_regioni_istat as dr where q.qq>1000000 and q.id_loc=c.id_comune and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=dr.id_regione group by r.denominazione, dr.id_sort order by dr.id_sort
TAVOLA09_1 = select t.descrizione as descrizione from tipologia_funzionale as t where t.id_tipologia_funzionale>0
TAVOLA09_2 = select q.descriz as descrizione0, count(*) as count_manca from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, t.descrizione as descriz from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, tipologia_funzionale as t, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and biblio.id_tipologia_funzionale=t.id_tipologia_funzionale and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, t.descrizione ) as q where q.qq=0 group by q.descriz order by q.descriz
TAVOLA09_3 = select q.descriz as descrizione1, count(*) as count_fino from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, t.descrizione as descriz from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, tipologia_funzionale as t, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and biblio.id_tipologia_funzionale=t.id_tipologia_funzionale and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, t.descrizione ) as q where q.qq>0 and q.qq<=2000 group by q.descriz order by q.descriz
TAVOLA09_4 = select q.descriz as descrizione2, count(*) as count_da_2001 from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, t.descrizione as descriz from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, tipologia_funzionale as t, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and biblio.id_tipologia_funzionale=t.id_tipologia_funzionale and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, t.descrizione ) as q where q.qq>2000 and q.qq<=5000 group by q.descriz order by q.descriz
TAVOLA09_5 = select q.descriz as descrizione3, count(*) as count_da_5001 from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, t.descrizione as descriz from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, tipologia_funzionale as t, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and biblio.id_tipologia_funzionale=t.id_tipologia_funzionale and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, t.descrizione ) as q where q.qq>5000 and q.qq<=10000 group by q.descriz order by q.descriz
TAVOLA09_6 = select q.descriz as descrizione4, count(*) as count_da_10001 from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, t.descrizione as descriz from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, tipologia_funzionale as t, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and biblio.id_tipologia_funzionale=t.id_tipologia_funzionale and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, t.descrizione ) as q where q.qq>10000 and q.qq<=100000 group by q.descriz order by q.descriz
TAVOLA09_7 = select q.descriz as descrizione5, count(*) as count_da_100001 from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, t.descrizione as descriz from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, tipologia_funzionale as t, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and biblio.id_tipologia_funzionale=t.id_tipologia_funzionale and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, t.descrizione ) as q where q.qq>100000 and q.qq<=500000 group by q.descriz order by q.descriz
TAVOLA09_8 = select q.descriz as descrizione6, count(*) as count_da_500001 from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, t.descrizione as descriz from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, tipologia_funzionale as t, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and biblio.id_tipologia_funzionale=t.id_tipologia_funzionale and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, t.descrizione ) as q where q.qq>500000 and q.qq<=1000000 group by q.descriz order by q.descriz
TAVOLA09_9 = select q.descriz as descrizione7, count(*) as count_oltre from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, t.descrizione as descriz from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, tipologia_funzionale as t, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and biblio.id_tipologia_funzionale=t.id_tipologia_funzionale and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, t.descrizione ) as q where q.qq>1000000 group by q.descriz order by q.descriz
TAVOLA10_1 = select id_ente_tipologia_amministrativa as id_amm, descrizione as des_amm from ente_tipologia_amministrativa where id_ente_tipologia_amministrativa>0 and (id_ente_tipologia_amministrativa % 100)=0
TAVOLA10_2 = select q.descriz as descrizione, count(*) as count_manca from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, te.id_ente_tipologia_amministrativa as descriz, te.descrizione as descrizioneEstesa from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente_tipologia_amministrativa as te, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa = te.id_ente_tipologia_amministrativa and te.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, te.id_ente_tipologia_amministrativa, te.descrizione) as q where q.qq=0 group by q.descriz, q.descrizioneEstesa order by q.descrizioneEstesa
TAVOLA10_3 = select q.descriz as descrizione1, count(*) as count_fino from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, te.id_ente_tipologia_amministrativa as descriz, te.descrizione as descrizioneEstesa from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente_tipologia_amministrativa as te, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa = te.id_ente_tipologia_amministrativa and te.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, te.id_ente_tipologia_amministrativa, te.descrizione) as q where q.qq>0 and q.qq<=2000 group by q.descriz, q.descrizioneEstesa order by q.descrizioneEstesa
TAVOLA10_4 = select q.descriz as descrizione2, count(*) as count_da_2001 from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, te.id_ente_tipologia_amministrativa as descriz, te.descrizione as descrizioneEstesa from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente_tipologia_amministrativa as te, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa = te.id_ente_tipologia_amministrativa and te.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, te.id_ente_tipologia_amministrativa, te.descrizione) as q where q.qq>2000 and q.qq<=5000 group by q.descriz, q.descrizioneEstesa order by q.descrizioneEstesa
TAVOLA10_5 = select q.descriz as descrizione3, count(*) as count_da_5001 from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, te.id_ente_tipologia_amministrativa as descriz, te.descrizione as descrizioneEstesa from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente_tipologia_amministrativa as te, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa = te.id_ente_tipologia_amministrativa and te.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, te.id_ente_tipologia_amministrativa, te.descrizione) as q where q.qq>5000 and q.qq<=10000 group by q.descriz, q.descrizioneEstesa order by q.descrizioneEstesa
TAVOLA10_6 = select q.descriz as descrizione4, count(*) as count_da_10001 from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, te.id_ente_tipologia_amministrativa as descriz, te.descrizione as descrizioneEstesa from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente_tipologia_amministrativa as te, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa = te.id_ente_tipologia_amministrativa and te.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, te.id_ente_tipologia_amministrativa, te.descrizione) as q where q.qq>10000 and q.qq<=100000 group by q.descriz, q.descrizioneEstesa order by q.descrizioneEstesa
TAVOLA10_7 = select q.descriz as descrizione5, count(*) as count_da_100001 from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, te.id_ente_tipologia_amministrativa as descriz, te.descrizione as descrizioneEstesa from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente_tipologia_amministrativa as te, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa = te.id_ente_tipologia_amministrativa and te.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, te.id_ente_tipologia_amministrativa, te.descrizione) as q where q.qq>100000 and q.qq<=500000 group by q.descriz, q.descrizioneEstesa order by q.descrizioneEstesa
TAVOLA10_8 = select q.descriz as descrizione6, count(*) as count_da_500001 from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, te.id_ente_tipologia_amministrativa as descriz, te.descrizione as descrizioneEstesa from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente_tipologia_amministrativa as te, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa = te.id_ente_tipologia_amministrativa and te.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4  group by biblio.id_biblioteca, te.id_ente_tipologia_amministrativa, te.descrizione) as q where q.qq>500000 and q.qq<=1000000 group by q.descriz, q.descrizioneEstesa order by q.descrizioneEstesa
TAVOLA10_9 = select q.descriz as descrizione7, count(*) as count_oltre from (select distinct biblio.id_biblioteca as id_bib, sum(p.quantita) as qq, te.id_ente_tipologia_amministrativa as descriz, te.descrizione as descrizioneEstesa from patrimonio as p, patrimonio_specializzazione as ps, biblioteca as biblio, ente_tipologia_amministrativa as te, ente as e where p.id_biblioteca=biblio.id_biblioteca and biblio.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa = te.id_ente_tipologia_amministrativa and te.id_ente_tipologia_amministrativa>0 and p.id_patrimonio_specializzazione=ps.id_patrimonio_specializzazione and ps.id_patrimonio_specializzazione_categoria=4 and biblio.id_tipologia_funzionale>0 and not(biblio.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and biblio.id_stato_biblioteca_workflow != 4 group by biblio.id_biblioteca, te.id_ente_tipologia_amministrativa, te.descrizione) as q where q.qq>1000000 group by q.descriz, q.descrizioneEstesa order by q.descrizioneEstesa
GRAFICO01_1 = select id_ente_tipologia_amministrativa as id_amm, descrizione as des_amm from ente_tipologia_amministrativa where id_ente_tipologia_amministrativa>0 and (id_ente_tipologia_amministrativa % 100)=0
GRAFICO01_2 = select te.id_ente_tipologia_amministrativa as tipologia_amministrativa_id, te.descrizione as tipologia_amministrativa, count(*) as count from biblioteca as b, ente_tipologia_amministrativa as te, ente as e where b.id_ente=e.id_ente and te.id_ente_tipologia_amministrativa=e.id_ente_tipologia_amministrativa and te.id_ente_tipologia_amministrativa>0 and b.id_tipologia_funzionale>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by te.id_ente_tipologia_amministrativa, te.descrizione order by te.descrizione
GRAFICO02_1 = select r.denominazione as descrizione_zona, b.accesso_riservato as stato_accesso, count(*) as count from dati_regioni_istat as dr, biblioteca as b, comune as c, provincia as p, regione as r, ente as e where  b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and dr.id_regione=r.id_regione and b.id_tipologia_funzionale>0 and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc))  and b.id_stato_biblioteca_workflow != 4 group by dr.descrizione_zona, b.accesso_riservato
GRAFICO03_1 = select r.denominazione as regione3, count(*) as numero_biblioteche from (select b.id_comune as idL, b.id_biblioteca as idB from biblioteca as b, tipologia_funzionale as t, ente as e, ente_tipologia_amministrativa as te where b.id_tipologia_funzionale=t.id_tipologia_funzionale and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa=te.id_ente_tipologia_amministrativa and t.id_tipologia_funzionale>0 and te.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and b.id_stato_biblioteca_workflow != 4) as q1, comune as c, provincia as pr, regione as r, dati_regioni_istat as d where q1.idL=c.id_comune and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=d.id_regione group by r.denominazione, d.id_sort order by d.id_sort
GRAFICO03_2 = select count(*) as cataloghi, q1.regione1 as regione from(select distinct q2.idB as idB, q2.idL as idL, r.denominazione as regione1, d.id_sort as sort from (select b.id_comune as idL, b.id_biblioteca as idB from biblioteca as b, tipologia_funzionale as t, ente as e, ente_tipologia_amministrativa as te where b.id_tipologia_funzionale=t.id_tipologia_funzionale and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa=te.id_ente_tipologia_amministrativa and t.id_tipologia_funzionale>0 and te.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and b.id_stato_biblioteca_workflow != 4) as q2, partecipa_cataloghi_generali as cat, regione as r, comune as c, provincia as pr, dati_regioni_istat as d where q2.idB=cat.id_biblioteca and c.id_comune=q2.idL and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=d.id_regione order by d.id_sort) as q1 group by q1.regione1, q1.sort order by q1.sort
GRAFICO03_3 = select count(*) as cataloghi_online, q1.regione1 as regione2 from(select distinct q2.idB as idB, q2.idL as idL, r.denominazione as regione1, d.id_sort as sort from (select b.id_comune as idL, b.id_biblioteca as idB from biblioteca as b, tipologia_funzionale as t, ente as e, ente_tipologia_amministrativa as te where b.id_tipologia_funzionale=t.id_tipologia_funzionale and b.id_ente=e.id_ente and e.id_ente_tipologia_amministrativa=te.id_ente_tipologia_amministrativa and t.id_tipologia_funzionale>0 and te.id_ente_tipologia_amministrativa>0 and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) and b.id_stato_biblioteca_workflow != 4) as q2, partecipa_cataloghi_generali as cat, cataloghi_supporto_digitale_tipo as catt, regione as r, comune as c, provincia as pr, dati_regioni_istat as d where q2.idB=cat.id_biblioteca and cat.id_cataloghi_supporto_digitale_tipo=catt.id_cataloghi_supporto_digitale_tipo and catt.descrizione='Online' and c.id_comune=q2.idL and c.id_provincia=pr.id_provincia and pr.id_regione=r.id_regione and r.id_regione=d.id_regione order by d.id_sort) as q1 group by q1.regione1, q1.sort order by q1.sort
GEOREFERENZIAZIONE01_1 = SELECT b.id_biblioteca as id1, b.isil_stato as isil_st, b.isil_numero as isil_nr, b.isil_provincia as isil_pr, b.denominazione_ufficiale as denominazione, b.indirizzo as indirizzo, b.frazione as frazione, b.cap as cap, c.denominazione as comune, r.denominazione as regione, p.denominazione as provincia FROM biblioteca b, regione r, provincia p, comune c WHERE b.id_comune=c.id_comune and c.id_provincia=p.id_provincia and p.id_regione=r.id_regione and b.id_stato_biblioteca_workflow != 4 and b.id_biblioteca BETWEEN 'X' AND 'Y' and not(b.id_biblioteca in (select sc.id_biblioteca from stato_catalogazione as sc)) ORDER BY id1